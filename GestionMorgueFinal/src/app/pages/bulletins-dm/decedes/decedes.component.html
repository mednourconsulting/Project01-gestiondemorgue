<nb-card>
  <nb-card-header class="card-header bg-info">
    <div class="row">
      <div class="col-sm-12">Ajouter Les Informations D'un Décédé</div>
    </div>
  </nb-card-header>
  <nb-card-body>
    <nb-tabset>
      <nb-tab tabTitle="Les informations sur le décédé">
        <form autocomplete="off" [formGroup]="reactiveForm">
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Nom du décédé</label>
                <input
                  formControlName="nom"
                  class="form-control"
                  type="text"
                  required
                >
                <ngx-validation-message label="Nom décédé"
                                        [showRequired]="!getControl('nom').valid && getControl('nom').touched"
                                        [fr]="getControl('nom')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Prénom du décédé</label>
                <input formControlName="prenom"
                       required
                       class="form-control"
                >
                <ngx-validation-message label="Prenom décédé"
                                        [showRequired]="!getControl('prenom').valid && getControl('prenom').touched"
                                        [fr]="getControl('prenom')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Sexe</label>
                <nb-select class="type-select form-control "
                           formControlName="sexe"
                           fullWidth
                           required>
                  <nb-option *ngFor="let t of sexeList" [value]="t.value">{{t.title}}</nb-option>
                </nb-select>
                <ngx-validation-message label="Sexe"
                                        [showRequired]="!getControl('sexe').valid && getControl('sexe').touched">
                </ngx-validation-message>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Date de décès</label>
                <input class="form-control"
                       formControlName="dateDeces"
                       type="Date"
                       name="dateDeces"
                       required
                       id="dateD"
                >
                <ngx-validation-message label="Date décès"
                                        [showRequired]="!getControl('dateDeces').valid && getControl('dateDeces').touched">
                </ngx-validation-message>

              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Date de naissance</label>
                <input class="form-control"
                       formControlName="dateNaissance"
                       type="Date"
                       name="dateNaissance"
                       required
                       id="DateNai"
                >
                <ngx-validation-message label="Date de naissance"
                                        [showRequired]="!getControl('dateNaissance').valid && getControl('dateNaissance').touched">
                </ngx-validation-message>
                <p  class="error-message caption status-danger" *ngIf=" compareDates && getControl('dateNaissance').touched">
                  La date du décès doit être supérieure ou égale à la date de naissance !
                </p>
              </div>
            </div>
            <div class="col-sm-4">
              <nb-checkbox id="defaultCheck" formControlName="mortNe"> S'agit-il d'un mort né</nb-checkbox>
              <p  class="error-message caption status-danger" *ngIf=" compareDates && getControl('dateDeces').touched && getControl('mortNe').value === true ">
                La date du décès doit être égale à la date de naissance !
              </p>
            </div>

          </div>
          <div class="row">
            <div *ngIf="createDecedeFromForm().sexe ==='Femme' && !compareDates &&(this.getAgeParAnnee(createDecedeFromForm().dateNaissance, createDecedeFromForm().dateDeces) < 54)
                             &&(this.getAgeParAnnee(createDecedeFromForm().dateNaissance, createDecedeFromForm().dateDeces) > 12);then contenu"></div>
            <ng-template #contenu>
              <div class="col-sm-8">
                <div class="form-group">
                  <label class="label">Le décès est-il survenu pendant une grossesse ou moins d'un an après sa
                    terminaison ?</label>
                  <nb-select formControlName="decesGrossesse" class="type-select " fullWidth>
                    <nb-option *ngFor="let t of confirmationList" [value]="t.value">{{t.title}}</nb-option>
                  </nb-select>
                </div>
              </div>
            </ng-template>
          </div>
          <div class="row">
            <div *ngIf="createDecedeFromForm().decesGrossesse==='Oui';then conten"></div>
            <ng-template #conten>
              <div class="row">
                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="label">le décès de la femme est-il survenu..?</label>
                    <nb-select formControlName="decesFemme" class="type-select form-control" fullWidth>
                      <nb-option *ngFor="let t of decesFemmeList" [value]="t.value">{{t.title}}</nb-option>
                    </nb-select>

                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="label">La grossesse a-t-elle contribué au decès ?</label>
                    <nb-select formControlName="contribueGros" class="type-select form-control" fullWidth>
                      <nb-option *ngFor="let t of confirmationList" [value]="t.value">{{t.title}}</nb-option>
                    </nb-select>

                  </div>
                </div>
              </div>
            </ng-template>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <div
                *ngIf="createDecedeFromForm().mortNe===true || (!compareDates && (this.getAgeParJour(createDecedeFromForm().dateNaissance, createDecedeFromForm().dateDeces)<7));then res"></div>
              <ng-template #res>
                <div class="row">

                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Grossesse multiple?</label>
                      <nb-select formControlName="grossesseMultiple" class="type-select form-control " fullWidth>
                        <nb-option *ngFor="let t of confirmationList" [value]="t.value">{{t.title}}</nb-option>
                      </nb-select>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Age de la mère</label>
                      <input formControlName="ageMere" class="form-control" type="text" id="ageMere">
                      <ngx-validation-message label="Age de la mère"
                                              [fr]="getControl('ageMere')?.hasError('pattern')">
                      </ngx-validation-message>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Poids à la naissance</label>
                      <input formControlName="poidsNaissance" class="form-control" type="text" id="poids">
                      <ngx-validation-message label="Poids à la naissance"
                                              [fr]="getControl('poidsNaissance')?.hasError('pattern')">
                      </ngx-validation-message>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-6">
                    <div class="form-group">
                      <label class="label">Age gestationnel</label>
                      <input formControlName="ageGestationnel" class="form-control" type="text" id="ageGestationnel">
                      <ngx-validation-message label="Age gestationnel"
                                              [fr]="getControl('ageGestationnel')?.hasError('pattern')">
                      </ngx-validation-message>
                    </div>
                  </div>
                  <div class="col-sm-6">
                    <div class="form-group">
                      <label class="label">Maladie ou affection maternelle ayant affecté le foetus ou le
                        nouveau-né</label>
                      <input formControlName="maladie" class="form-control" type="text" id="maladie">
                      <ngx-validation-message label="Maladie ou affectation"
                                              [fr]="getControl('maladie')?.hasError('pattern')">
                      </ngx-validation-message>
                    </div>
                  </div>
                </div>
              </ng-template>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Lieu de naissance</label>
                <input formControlName="lieuNaiss"
                       class="form-control"
                       type="text"


                       name="naissance"
                       required
                       id="LieuNai"
                >
                <ngx-validation-message label="Lieu de naissance"
                                        [showRequired]="!getControl('lieuNaiss').valid && getControl('lieuNaiss').touched"
                                        [fr]="getControl('lieuNaiss')?.hasError('pattern')">
                </ngx-validation-message>


              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Nationalité</label>
                <input formControlName="nationalite"
                       class="form-control"
                       type="text"
                       name="nationalite"
                       required


                       id="nationalite"
                >
                <ngx-validation-message label="Nationalité"
                                        [showRequired]="!getControl('nationalite').valid && getControl('nationalite').touched"
                                        [fr]="getControl('nationalite')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">CIN</label>
                <input formControlName="cin"
                       class="form-control"
                       type="text"
                       name="CIN"
                       required


                       id="cin"
                >
                <ngx-validation-message label="CIN"
                                        [showRequired]="!getControl('cin').valid && getControl('cin').touched"
                                        [fr]="getControl('cin')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Adresse</label>
                <input formControlName="adresse"
                       class="form-control"
                       type="text"


                       name="adresse"
                       required
                       id="adresse"
                >
                <ngx-validation-message label="Adresse"
                                        [showRequired]="!getControl('adresse').valid && getControl('adresse').touched"
                                        [fr]="getControl('adresse')?.hasError('pattern')">
                </ngx-validation-message>

              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Etat Matrimonial</label>
                <nb-select formControlName="etat"
                           class="type-select form-control"

                           required
                           fullWidth
                >
                  <nb-option *ngFor="let t of etatList" [value]="t.value"> {{t.title}}</nb-option>
                </nb-select>
                <ngx-validation-message label="Etat Matrimonial"
                                        [showRequired]="!getControl('etat').valid && getControl('etat').touched"
                                        [fr]="getControl('etat')?.hasError('pattern')">
                </ngx-validation-message>

              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Nom du père ou mère</label>
                <input formControlName="fils"
                       class="form-control"
                       type="text"

                       name="fils"
                       required

                       id="fils"
                >
                <ngx-validation-message label="Nom du père ou mère"
                                        [showRequired]="!getControl('fils').valid && getControl('fils').touched"
                                        [fr]="getControl('fils')?.hasError('pattern')">
                </ngx-validation-message>

              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Heure de décès</label>
                <input formControlName="heure"
                       class="form-control"
                       type="text"
                       name="heure"
                       required
                       id="heure"
                       placeholder="exemple 05:10pm">
                <ngx-validation-message label="Heure de décès"
                                        [showRequired]="!getControl('heure').valid && getControl('heure').touched"
                                        [heurePattern]="getControl('heure')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Lieu Décès</label>
                <nb-select formControlName="lieuxDeces"
                           class="type-select form-control"
                           name="lieuxDeces"
                           required
                           fullWidth
                >
                  <nb-option *ngFor="let t of lieuDecesList" [value]="t.value">{{t.title}}</nb-option>
                </nb-select>
                <ngx-validation-message label="Lieu Décès"
                                        [showRequired]="!getControl('lieuxDeces').valid && getControl('lieuxDeces').touched"
                                        [fr]="getControl('lieuxDeces')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Nature de la mort</label>
                <nb-select formControlName="natureMort"
                           class="type-select form-control"
                           name="natureMort"
                           required
                           fullWidth
                >
                  <nb-option *ngFor="let t of natureMortList" [value]="t.value">{{t.title}}</nb-option>
                </nb-select>
                <ngx-validation-message label="Nature de la mort"
                                        [showRequired]="!getControl('natureMort').valid && getControl('natureMort').touched">
                </ngx-validation-message>

              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Préfecture d'arrondissements</label>
                <input formControlName="prefectureD" class="form-control" type="text"
                       id="prefect">
                <ngx-validation-message label="Heure de décès"
                                        [fr]="getControl('provinceD')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Commune /Arrondissements</label>
                <input formControlName="prefectureD" class="form-control" type="text" id="communeD">
                <ngx-validation-message label="Commune /Arrondissements"
                                        [fr]="getControl('prefectureD')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Préfecture /Province</label>
                <nb-select formControlName="provinceD"
                           class="type-select form-control" fullWidth>
                  <nb-option *ngFor="let t of provinceList" [value]="t.value"> {{t.title}}</nb-option>
                </nb-select>
                <ngx-validation-message label="Préfecture /Province"
                                        [fr]="getControl('provinceD')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
          </div>
          <div class="row">

            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Cause de mort</label>
                <nb-select formControlName="causeMort" class="type-select form-control" fullWidth>
                  <nb-option *ngFor="let cm of causeMort" [value]="cm">{{cm}}</nb-option>
                  <nb-option *ngFor="let c of causes" [value]="c.description">{{c.description}}</nb-option>

                </nb-select>
              </div>
            </div>

            <div class="col-sm-4">
              <div class="form-group">
                <label class="label"> Cause initiale </label>
                <nb-select formControlName="causeInitial" class="type-select form-control" fullWidth>
                  <nb-option *ngFor="let cm of causeMort" [value]="cm">{{cm}}</nb-option>
                  <nb-option *ngFor="let t of causes" [value]="t.description">{{t.description}}</nb-option>
                </nb-select>

              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Cause immédiate</label>
                <nb-select formControlName="causeImmdiate" class="type-select form-control" fullWidth>
                  <nb-option *ngFor="let cm of causeMort" [value]="cm">{{cm}}</nb-option>
                  <nb-option *ngFor="let t of causes" [value]="t.description">{{t.description}}</nb-option>
                </nb-select>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label"> Profession </label>
                <input formControlName="profession"
                       class="form-control"
                       type="text"
                       name="profession"
                       id="profession">
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <div *ngIf="(createDecedeFromForm().natureMort === 'Mort non naturelle') then survenu">
              </div>
              <ng-template #survenu>
                <div class="row">
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Date de survenue</label>
                      <input class="form-control"
                             formControlName="dateServ"
                             type="Date"
                             id="DateServ">
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Lieu de survenue</label>
                      <nb-select formControlName="lieuServ"
                                 class="type-select form-control"
                                 fullWidth
                      >
                        <nb-option *ngFor="let t of lieuList" [value]="t.value">{{t.title}}</nb-option>
                      </nb-select>
                      <ngx-validation-message label="Lieu de survenue"
                                              [fr]="getControl('lieuServ')?.hasError('pattern')">
                      </ngx-validation-message>

                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Circonstances de survenue</label>
                      <input class="form-control"
                             formControlName="circonServ"
                             type="text"


                             id="circonstances"
                      >
                      <ngx-validation-message label="Circonstances de survenue"
                                              [fr]="getControl('circonServ')?.hasError('pattern')">
                      </ngx-validation-message>
                    </div>
                  </div>
                </div>

              </ng-template>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <nb-checkbox id="defaultCheck1" formControlName="obstacle">Obstacle medicolégal</nb-checkbox>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Autopsie</label>
                <nb-select formControlName="autopsie" class="type-select form-control" fullWidth>
                  <nb-option *ngFor="let t of confirmationList" [value]="t.value">{{t.title}}</nb-option>
                </nb-select>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <label class="label">Une operation a-t-elle été effectuées lors des 4 dernières semaines ?</label>
                <nb-select formControlName="operation" class="type-select form-control" fullWidth>
                  <nb-option *ngFor="let t of confirmationList" [value]="t.value">{{t.title}}</nb-option>
                </nb-select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <div *ngIf="createDecedeFromForm().autopsie === 'Oui'then resultAutopsie"></div>
              <ng-template #resultAutopsie>
                <div class="row">
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">les résultats ont-ils été utilisés dans certification</label>
                      <nb-select formControlName="resultatsAutopsie" class="type-select form-control" fullWidth>
                        <nb-option *ngFor="let t of confirmationList" [value]="t.value">{{t.title}}</nb-option>
                      </nb-select>
                    </div>
                  </div>
                </div>
              </ng-template>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <div *ngIf="createDecedeFromForm().operation==='Oui'then resOperation"></div>
              <ng-template #resOperation>
                <div class="row">
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">La date d'operation</label>
                      <input formControlName="dateOperation" class="form-control" type="Date" id="dateOp">
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label class="label">Motif d'operation</label>
                      <input formControlName="motifOperation" class="form-control" type="text" id="motif">
                      <ngx-validation-message label="Motif d'operation"
                                              [fr]="getControl('motifOperation')?.hasError('pattern')">
                      </ngx-validation-message>
                    </div>
                  </div>
                </div>
              </ng-template>
            </div>
          </div>
        </form>
      </nb-tab>
      <nb-tab tabTitle="معلومات عن المتوفى">
        <form [formGroup]="reactiveForm">
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group arabe">
                <label class="label float-right">الإسم العائلي</label>
                <input formControlName="nomAR" class="form-control" type="text" id="NomAR" required>
                <ngx-validation-message label="الإسم العائلي"
                                        [showRequired]="!getControl('nomAR').valid && getControl('nomAR').touched"
                                        [ar]="getControl('nomAR')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group arabe">
                <label class="label float-right">الإسم الشخصي</label>
                <input formControlName="prenomAR" class="form-control" type="text" id="prenomAR" required>
                <ngx-validation-message label="الإسم الشخصي"
                                        [showRequired]="!getControl('prenomAR').valid && getControl('prenomAR').touched"
                                        [ar]="getControl('prenomAR')?.hasError('pattern')">
                </ngx-validation-message>

              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group arabe">
                <label class="label float-right">الجنسية</label>
                <input formControlName="nationaliteAR" class="form-control" type="text" id="nationaliteAR" required>
                <ngx-validation-message label="الجنسية"
                                        [showRequired]="!getControl('nationaliteAR').valid && getControl('nationaliteAR').touched"
                                        [ar]="getControl('nationaliteAR')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group arabe">
                <label class="label float-right">مكان الوفاة</label>
                <input formControlName="lieuDecesAR" class="form-control" required type="text" id="LieuDecesAr">
                <ngx-validation-message label="مكان الوفاة"
                                        [showRequired]="!getControl('lieuDecesAR').valid && getControl('lieuDecesAR').touched"
                                        [ar]="getControl('lieuDecesAR')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group arabe">
                <label class="label float-right">العنوان</label>
                <input formControlName="adresseAR" class="form-control" required type="text" id="adresseAR">
                <ngx-validation-message label="العنوان"
                                        [showRequired]="!getControl('adresseAR').valid && getControl('adresseAR').touched"
                                        [ar]="getControl('adresseAR')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group arabe ">
                <label class="label float-right">إسم الأب أو الأم</label>
                <input formControlName="filsAR"
                       class="form-control" required
                       type="text" id="FilsAR">
                <ngx-validation-message label="إسم الأب أو الأم"
                                        [showRequired]="!getControl('filsAR').valid && getControl('filsAR').touched"
                                        [ar]="getControl('filsAR')?.hasError('pattern')">
                </ngx-validation-message>
              </div>
            </div>
          </div>
        </form>
      </nb-tab>
    </nb-tabset>
    <form [formGroup]="reactiveForm">
      <div class="float-right">
        <button class="btn mr-1 " (click)="onSubmit()" type="submit" nbButton status="info">Enregistrer</button>
        <button class="btn btn-secondary mr-1" (click)="reactiveForm.reset()" nbButton status="info" outline>Annuler
        </button>
      </div>
    </form>
  </nb-card-body>
</nb-card>
<nb-card>
  <nb-card-header class="card-header bg-info">
    <div class="row">
      <div class="col-sm-12"> Liste des décédés</div>
    </div>
  </nb-card-header>
  <div class="table table-responsive">
    <ng2-smart-table [settings]="settings" [source]="source" (custom)="onCustomConfirm($event)">
    </ng2-smart-table>
  </div>
</nb-card>
