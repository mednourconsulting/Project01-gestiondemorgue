

<nb-card>
    <nb-card-header>
        <div class="row">
            <div class="col-sm-12">Ajouter un certificat médico-légal</div>
        </div>
    </nb-card-header>
    <nb-card-body>
      <form autocomplete="off"  [formGroup]="reactiveForm">
        <div class="row">
            <div class="col-sm-4">
                <div class="form-group">
                    <label class="label">Médecin</label>

                  <input #autoMedcin
                         type="text"
                         formControlName="medecin" class="form-control "
                         (input)="onChangeMedcin()"
                         placeholder="Médecin"
                         [nbAutocomplete]="auto" />
                  <nb-autocomplete #auto (selectedChange)="onSelectionChangeMedcin($event)">
                    <nb-option class="url"  (click)="passToMedecin()">Ajouter un Médecin....</nb-option>
                    <nb-option *ngFor="let option of filteredListMedcin$ | async" [value]="option">
                      {{ option }}
                    </nb-option>

                  </nb-autocomplete>
                    <!--nb-select formControlName="medecin"
                               class="type-select "
                               nbSelect
                               fullWidth
                               placeholder="Médecin"
                               required="true">
                      <nb-option class="url"  (click)="passToMedecin()">Ajouter un Médecin....</nb-option>
                      <nb-option *ngFor="let t of NomMedecin" [value]="t.id" > {{t.id}} : {{ t.nom }} {{ t.prenom }}</nb-option>
                    </nb-select-->
                  <ngx-validation-message label="Médecin"
                                          [showRequired]="!getControl('medecin').valid && getControl('medecin').touched">
                  </ngx-validation-message>

                </div>
            </div>
            <div class="col-sm-4">
                <div class="form-group">
                    <label class="label">Défunt</label>
                    <!--nb-select formControlName="defunt"
                               class="type-select "
                               nbSelect
                               fullWidth
                               placeholder="Défunt"
                               required="true">
                      <nb-option class="url" (click)="passToDecede()">Ajouter un Décédé....</nb-option>
                      <nb-option *ngFor="let t of NomDecede" [value]="t.id" > {{t.id}} : {{ t.nom }} {{ t.prenom }}</nb-option>
                    </nb-select-->
                  <input #autoDecede
                         type="text"
                         formControlName="defunt"
                         class="form-control "
                         (input)="onChangeDecede()"
                         placeholder="Défunt"
                         [nbAutocomplete]="autoM" />

                  <nb-autocomplete #autoM (selectedChange)="onSelectionChangeDecede($event)">
                    <nb-option class="url" (click)="passToDecede()">Ajouter un Décédé....</nb-option>
                    <nb-option *ngFor="let option of filteredListDecede$ | async" [value]="option">
                      {{ option }}
                    </nb-option>

                  </nb-autocomplete>
                  <ngx-validation-message label="Défunt"
                                          [showRequired]="!getControl('defunt').valid && getControl('defunt').touched">
                  </ngx-validation-message>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="form-group">
                    <label class="label">Déclarant</label><br>
                    <input formControlName="declarant"
                           class="form-control"
                           type="text"
                           id="dec"
                           placeholder="Déclarant"
                           required="true">
                  <ngx-validation-message label="Déclarant"
                                          [showRequired]="!getControl('declarant').valid && getControl('declarant').touched"
                                          [fr]="getControl('declarant')?.hasError('pattern')">
                  </ngx-validation-message>
                </div>
            </div>

        </div>

        <div class="row">
            <div class="col-sm-4">
                <div class="form-group">
                    <label class="label">CIN Déclarant</label><br>
                    <input formControlName="cin"
                           [ngModel]="this.Medicolegal.cin"
                           class="form-control"
                           type="text"
                           id="cin"
                           placeholder="CIN Déclarant"
                    >
                  <ngx-validation-message label="CIN Déclarant"
                                          [fr]="getControl('cin')?.hasError('pattern')">
                  </ngx-validation-message>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="form-group">
                    <label class="label">Adresse Déclarant</label><br>
                    <input formControlName="address"
                           class="form-control"
                           type="text"
                           id="adresse"
                           placeholder="Adresse Déclarant"
                           required="true">
                  <ngx-validation-message label="Adresse Déclarant"
                                          [showRequired]="!getControl('address').valid && getControl('address').touched"
                                          [addressFr]="getControl('address')?.hasError('pattern')">
                  </ngx-validation-message>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="form-group">
                    <label class="label">Date déclaration</label>
                    <input formControlName="declaration"
                           class="form-control"
                           type="Date"
                           id="datedec"
                           placeholder="Date déclaration"
                    >

                </div>
            </div>

        </div>
        <div class="float-right">
            <button class="btn mr-1 " (click)="onSubmit()" type="submit" nbButton status="success">Enregistrer</button>
            <button class="btn mr-1 " (click)="reset()" nbButton status="success" outline>Annuler</button>
        </div>
      </form>
    </nb-card-body>

</nb-card>


<div class="card">
  <div class="card-header">
    Liste des certificats médico-légal
  </div>
  <div class="table table-responsive">

    <ng2-smart-table [settings]="settings"
                     [source]="source"
                     (custom)="onCustomConfirm($event)">
    </ng2-smart-table>
  </div>
</div>
